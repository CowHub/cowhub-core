machine:
  environment:
    # Setting the tag for Docker-hub
    TAG: $CIRCLE_BRANCH-$CIRCLE_SHA1
    DOCKER_IMAGE: cowhub/cowhub-core:$CIRCLE_BUILD_NUM-$CIRCLE_BRANCH-$CIRCLE_SHA1
  services:
    - docker

dependencies:
  override:
    - docker info

test:
  override:
    - mkdir -p publish
    - cp -r lib/* publish/
    - cp -r package/* publish/
    - cd publish && zip -r lamdba_package.zip .

deployment:
  production:
    branch: aws-lambda-redo
    commands:
      - cp -r lambda_package.zip $CIRCLE_ARTIFACTS/
