dependencies:
  override:
    - pip install awscli

test:
  override:
    - mkdir -p publish
    - cp -r lib/* publish/
    - cp -r package/* publish/
    - cd publish && zip -r lambda_package.zip .

deployment:
  production:
    branch: master
    commands:
      - cp -r publish/lambda_package.zip $CIRCLE_ARTIFACTS/
      - aws lambda update-function-code --region eu-west-1 --function-name cowhub-image-register --zip-file fileb://$PWD/publish/lambda_package.zip
